[source]
same_as = "../os-test"

[build]
template = "custom"
script = """
DYNAMIC_INIT

# Copy source to /usr/share/os-test
mkdir -p "${COOKBOOK_STAGE}/usr/share/os-test"
cd "${COOKBOOK_STAGE}/usr/share/os-test"
rsync -a "${COOKBOOK_SOURCE}/" "./"

# Pre-compile tests for Redox
make OS=Redox CC="${CC_WRAPPER} ${GNU_TARGET}-gcc" \
        CFLAGS= CPPFLAGS= \
        LDFLAGS= EXTRA_LDFLAGS= \
        CC_FOR_BUILD="${CC_WRAPPER} cc" CFLAGS_FOR_BUILD= CPPFLAGS_FOR_BUILD= \
        LDFLAGS_FOR_BUILD= -j ${COOKBOOK_MAKE_JOBS} all
"""
