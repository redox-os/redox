#TODO camino crate error
# broken since https://github.com/http-server-rs/http-server/pull/461
# because it needs https://trunkrs.dev to work
[source]
git = "https://github.com/http-server-rs/http-server"
shallow_clone = true

[build]
template = "custom"
dependencies = [
    "openssl3",
]
script = """
DYNAMIC_INIT
"${COOKBOOK_CARGO}" build \
        --manifest-path "${COOKBOOK_SOURCE}/crates/file-explorer-plugin/Cargo.toml" \
        --locked ${build_flags} --lib
cp -v \
    "target/${TARGET}/${build_type}/libfile_explorer_plugin.dylib" \
    "${COOKBOOK_SOURCE}"/lib/http-server/inline/file_explorer.plugin.httprs
PACKAGE_PATH=crates/http-server cookbook_cargo --bin http-server
"""
