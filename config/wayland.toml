# Wayland configuration

include = ["desktop.toml"]

# Override the default settings here

# General settings
[general]
# Filesystem size in MiB
filesystem_size = 2048

# Package settings
[packages]
adwaita-icon-theme = {}
bash = {}
cosmic-comp = {}
gtk3 = {}
libxcursor = {}
mesa = {}
smallvil = {}
softbuffer-wayland = {}
wayland-rs = {}
#webkitgtk3 = {}
winit-wayland = {}
xkeyboard-config = {}

[[files]]
path = "/usr/lib/init.d/10_wayland_env"
data = """
#TODO: mkdir -p not working
mkdir -p /tmp/run
mkdir -p /tmp/run/user
mkdir -p /tmp/run/user/0
glib-compile-schemas /usr/share/glib-2.0/schemas/
"""

# Overridden to launch smallvil instead of orblogin
[[files]]
path = "/usr/lib/init.d/20_orbital"
data = """
notify audiod
nowait BROWSER=/bin/netsurf-fb VT=3 orbital orbital-wayland
"""

[[files]]
path = "/usr/bin/orbital-wayland"
mode = 0o755
data = """
#!/usr/bin/env bash

export XDG_RUNTIME_DIR /tmp/run/user/0

unset DISPLAY
export COSMIC_BACKEND=winit
export LD_DEBUG=all
export RUST_BACKTRACE=full
export RUST_LOG=debug

# For cosmic-comp (more features)
cosmic-comp wayland-session

# For smallvil (easier to debug)
#export WAYLAND_DISPLAY=wayland-1
#smallvil_smallvil &
#sleep 2
#wayland-session
"""

[[files]]
path = "/usr/bin/wayland-session"
mode = 0o755
data = """
#!/usr/bin/env bash

#env G_MAIN_POLL_DEBUG=1 G_MESSAGES_DEBUG=all LD_DEBUG=all WEBKIT_DEBUG=all MiniBrowser&
printenv
#wayland-rs_simple_window
#winit-wayland_window
softbuffer-wayland_animation
"""

[[files]]
path = "/etc/gtk-3.0/settings.ini"
data = """
[Settings]
gtk-cursor-theme-name = "Adwaita"
gtk-icon-theme-name = "Adwaita"
"""
